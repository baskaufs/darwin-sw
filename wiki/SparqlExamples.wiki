#summary SPARQL examples.

Note: still under construction as of 2013-10-26

*Contents*

<wiki:toc max_depth="4" />

= Introduction =

The examples on this page illustrate how some simple SPARQL queries can be used to infer triples entailed by the {{{owl:inverseOf}}} and {{{owl:TransitiveProperty}}} declarations in Darwin-SW.  They also show how the range and domain declarations can be used together with the disjoint class declarations to reason whether triples in a graph are consistent.  Finally, examples are given which show how Darwin-SW relationships can address several competency questions of the sort that are important to the biodiversity informatics community.

=Preliminaries=

==SPARQL endpoint==

The examples shown here are currently (2013-10-25) loaded in the TDWG RDF Task Group triplestore/SPARQL endpoint sandbox at http://tdwg-rdf.net/store2/ .  

==Inverse property assertions==
The file http://darwin-sw.googlecode.com/svn/trunk/examples/inverse-assertions.rdf contains the following triples as RDF/XML (shown here as RDF/Turtle):
{{{
@prefix dcterms: <http://purl.org/dc/terms/>.
@prefix foaf: <http://xmlns.com/foaf/0.1/>.
@prefix owl: <http://www.w3.org/2002/07/owl#>.

dcterms:references owl:inverseOf dcterms:isReferencedBy.
dcterms:hasPart owl:inverseOf dcterms:isPartOf.
foaf:depiction owl:inverseOf foaf:depicts.
}}}

Of these three inverse property declarations, only the {{{foaf:}}} properties are actually asserted to be inverse in their defining RDF.  Although the {{{dcterms:}}} terms are not declared to be inverse properties by DCMI, it is reasonable to consider them to be inverse properties so we assert that here for convenience.

==Darwin-SW ontology document==

The file http://darwin-sw.googlecode.com/svn/trunk/dsw.owl is also loaded in the triplestore.  It (currently) contains the draft Darwin-SW version 0.3 which is under development pending acceptance of the proposed [http://code.google.com/p/tdwg-rdf/wiki/DwcRdf Darwin Core RDF Guide] by TDWG.  This is not the version that is served from purl.org when the terms are dereferenced.

= Namespace abbreviations =
The following namespaces are used in the examples.  The SPARQL examples omit them for brevity but they (or the necessary subset of them) must be included when actually running the queries on the endpoint.

{{{
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dc: <http://purl.org/dc/elements/1.1/>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
PREFIX dwc: <http://rs.tdwg.org/dwc/terms/>
PREFIX dwctype: <http://rs.tdwg.org/dwc/dwctype/>
PREFIX dwcuri: <http://rs.tdwg.org/dwc/uri/>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX dsw: <http://purl.org/dsw/>
PREFIX ac: <http://rs.tdwg.org/ac/terms/>
PREFIX xmp: <http://ns.adobe.com/xap/1.0/>
PREFIX xmpRights: <http://ns.adobe.com/xap/1.0/rights/>
PREFIX Iptc4xmpExt: <http://iptc.org/std/Iptc4xmpExt/2008-02-29/>
PREFIX photoshop: <http://ns.adobe.com/photoshop/1.0/>
PREFIX cc: <http://creativecommons.org/ns#>
PREFIX xhv: <http://www.w3.org/1999/xhtml/vocab#>
PREFIX mbank: <http://www.morphbank.net/schema/morphbank#>
PREFIX exif: <http://ns.adobe.com/exif/1.0/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX local: <http://bioimages.vanderbilt.edu/rdf/local#>
PREFIX tc: <http://rs.tdwg.org/ontology/voc/TaxonConcept#>
PREFIX txn:  <http://lod.taxonconcept.org/ontology/txn.owl#>
PREFIX stdview: <http://bioimages.vanderbilt.edu/rdf/stdview#>
}}}

=Example scenario=
The following diagrams illustrate graphically some of the triples representing relationships between resources that are included in the graphs which are queried in the SPARQL examples.  They represent a scenario in which specimens were collected during a bioblitz with subsequent identifications and creation of other resources derived from the original specimens.

http://darwin-sw.googlecode.com/svn/trunk/examples/bird-bioblitz.png

http://darwin-sw.googlecode.com/svn/trunk/examples/shell-bioblitz.png

http://darwin-sw.googlecode.com/svn/trunk/examples/starfish-bioblitz.png

= Inverse relationships =

==Why have inverse relationships?==

Each object property defined by Darwin-SW has a corresponding inverse property.  This allows any resource to be the subject a property that links it to an instance of another class that is adjacent in the Darwin-SW model.  Although it would be possible to have properties that only link in one direction, it would require more awkward structuring of the RDF if the focal resource were required to be the object of a triple rather than the subject.  By having an inverse of each object property, Darwin-SW supports the philosophy that resources are a connected network in which each component is important.  Any resource type of can be the "center of the universe" in Darwin-SW.

==Query to infer inverse relationships==

This query follows the rational explained at http://code.google.com/p/tdwg-rdf/wiki/SparqlReasoning .  If you are unfamiliar with SPARQL, you may want to review this example before proceeding.

This query only finds missing inverse triples for properties that are directly asserted to have an _owl:inverseOf_ property:

{{{
[prefix list goes here]

CONSTRUCT {?R1 ?Property2 ?R2}
FROM <http://darwin-sw.googlecode.com/svn/trunk/dsw.owl>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/inverse-assertions.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2013-03.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2013-06.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2018.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2017-02.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2017-04.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2025.rdf>
WHERE 
 {
 ?Property1 owl:inverseOf ?Property2.
 ?R2 ?Property1 ?R1.
 OPTIONAL 
      {
      ?R3 ?Property2 ?R2.
      FILTER(?R3 = ?R1).
      }
 FILTER(!BOUND(?R3))
 }
Limit 100
}}}
This query finds approximately 38 triples from the example whose inverse relationship is not explicitly stated.

There is another set of missing inverse triples for properties *whose inverse property* is declared to have an _owl:inverseOf_ property:

{{{
[prefix list goes here]

CONSTRUCT {?R1 ?Property1 ?R2}

FROM <http://darwin-sw.googlecode.com/svn/trunk/dsw.owl>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/inverse-assertions.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2013-03.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2013-06.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2018.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2017-02.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2017-04.rdf>
FROM <http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-2025.rdf>
WHERE 
 {
 ?Property1 owl:inverseOf ?Property2.
 ?R2 ?Property2 ?R1.
 OPTIONAL 
   {
   ?R3 ?Property1 ?R2.
   FILTER(?R3 = ?R1).
   }
 FILTER(!BOUND(?R3))
 }
Limit 100
}}}
This query finds the other approximately 15 missing inverse triples.

Note that one could avoid having to run these two queries if the Darwin-SW ontology file were changed to assert the _owl:inverseOf_ relationships both ways.  That has not been done because it isn't normal practice for OWL ontologies.  But for the sake of reducing the number of processing steps it could be done for the version of Darwin-SW loaded in the triple store.

The resulting triples have been included in the file http://darwin-sw.googlecode.com/svn/trunk/examples/dsw-0-3-use-case-inferred-inverse.rdf .  This file will be included in subsequent examples so that the queries can be run using any of the paired inverse object properties.

=Transitive properties=